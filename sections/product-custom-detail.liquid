<div class="product-layout">
  <div class="product-grid product-detail-grid">
    <!-- LEFT: Slick Slider -->
    <div class="product-gallery-wrapper">
      <div class="product-gallery-slider js-main-slider">
        {% for image in product.images %}
          <div class="slide">
            <img src="{{ image | image_url: width: 800 }}" alt="{{ product.title }}">
          </div>
        {% endfor %}
      </div>
      <div class="product-gallery-thumbs js-thumb-slider">
        {% for image in product.images %}
          <div class="thumb">
            <img src="{{ image | image_url: width: 160 }}" alt="{{ product.title }}">
          </div>
        {% endfor %}
      </div>
    </div>

    <!-- RIGHT: Product Info -->
    <div class="product-info">
      <h1 class="product-title">{{ product.title }}</h1>
      <p class="product-brand">Brand: <strong>{{ product.vendor }}</strong></p>
      <p class="product-price">Price: {{ product.price | money }}</p>

      {% assign rating = 0 %}
      {% for tag in product.tags %}
        {% if tag contains 'rating-' %}
          {% assign rating = tag | remove: 'rating-' | plus: 0 %}
        {% endif %}
      {% endfor %}
      {% assign reviews = product.metafields.custom.rating_count | default: 0 | plus: 0 %}
      {% assign full_stars = rating | floor %}
      {% assign has_half_star = rating | modulo: 1 | times: 10 | round %}
      {% assign empty_stars = 5 | minus: full_stars | minus: has_half_star %}

      <div class="product-rating">
        {% for i in (1..full_stars) %}<span>â˜…</span>{% endfor %}
        {% if has_half_star > 0 %}<span>ðŸŒ“</span>{% endif %}
        {% for i in (1..empty_stars) %}<span>â˜†</span>{% endfor %}
        <span>({{ reviews }} Reviews)</span>
      </div>

      <!-- Size Selector -->
      {% if product.options.size > 0 %}
        {% for option in product.options_with_values %}
          {% if option.name == 'Size' %}
            <label for="Size">Size:</label>
            <select id="Size" name="Size">
              {% for value in option.values %}
                <option value="{{ value }}">{{ value }}</option>
              {% endfor %}
            </select>
          {% endif %}
        {% endfor %}
      {% endif %}

      <!-- Quantity -->
      <label for="Quantity">Quantity:</label>
      <input type="number" id="Quantity" name="quantity" min="1" value="1">

      <!-- Add to Cart -->
      <form method="post" action="/cart/add">
        <input type="hidden" name="id" value="{{ product.variants.first.id }}">
        <button type="submit" class="btn-add-to-cart">Add to Cart</button>
      </form>

      <!-- Tabs -->
      <div class="product-tabs">
        <details open>
          <summary>Description</summary>
          <p>{{ product.description }}</p>
        </details>
        <details>
          <summary>Additional Information</summary>
          <p>{{ product.metafields.custom.additional_info }}</p>
        </details>
        <details>
          <summary>Reviews ({{ reviews }})</summary>
          <p>{{ product.metafields.custom.review_text }}</p>
        </details>
      </div>
    </div>
  </div>
</div>
